{"version":3,"sources":["queries/project.ts","components/pages/home/project/index.tsx","components/pages/home/project/index.module.scss"],"names":["findQuery","gql","_templateObject","getQuery","_templateObject2","createMutation","_templateObject3","css","require","Sider","Layout","Content","DashboardPage","React","lazy","__webpack_require__","e","then","bind","DataPage","ScriptsPage","SettingsPage","ExecutionPage","ProjectPage","props","_this$__routeNames","_this","Object","_System_Volumes_Data_crawl_zhuazi_ferret_server_ui_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","_System_Volumes_Data_crawl_zhuazi_ferret_server_ui_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_System_Volumes_Data_crawl_zhuazi_ferret_server_ui_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","call","collapsed","__routes","__routeNames","__handleMenuCollapseChange","_System_Volumes_Data_crawl_zhuazi_ferret_server_ui_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","path","concat","match","url","label","icon","component","/home/projects","_System_Volumes_Data_crawl_zhuazi_ferret_server_ui_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","params","id","__renderBreadcrumb","__renderRoutes","showText","state","selected","__currentTabKey","variables","getParam","react__WEBPACK_IMPORTED_MODULE_14___default","a","createElement","antd__WEBPACK_IMPORTED_MODULE_7__","className","layout","collapsible","onCollapse","antd__WEBPACK_IMPORTED_MODULE_8__","type","antd__WEBPACK_IMPORTED_MODULE_9__","theme","menu","selectedKeys","map","config","idx","key","toString","Item","react_router_dom__WEBPACK_IMPORTED_MODULE_16__","to","bottomMenu","contentLayout","react_apollo__WEBPACK_IMPORTED_MODULE_15__","query","content","antd__WEBPACK_IMPORTED_MODULE_10__","antd__WEBPACK_IMPORTED_MODULE_11__","lg","location","found","findIndex","i","startsWith","pathname","_this2","data","_ref","antd__WEBPACK_IMPORTED_MODULE_12__","style","margin","react_router_dom__WEBPACK_IMPORTED_MODULE_17__","BreadcrumbsItem","_ref2","item","title","output","name","isExact","Fragment","redirect","_this3","_this$props","react__WEBPACK_IMPORTED_MODULE_14__","fallback","_common_loader_loader__WEBPACK_IMPORTED_MODULE_19__","size","Component","projectId","assign","project","setState","Page","module","exports"],"mappings":"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","file":"static/js/17.9c6885f5.chunk.js","sourcesContent":["import gql from 'graphql-tag';\n\nexport const findQuery = gql`\n    query findProjects($query: Query) {\n        output(query: $query)\n            @rest(type: \"[Project]\", path: \"/projects?{args.query}\") {\n            paging\n            data\n        }\n    }\n`;\n\nexport const getQuery = gql`\n    query projectName($id: String!) {\n        output(id: $id) @rest(type: \"Project\", path: \"/projects/{args.id}\") {\n            name\n        }\n    }\n`;\n\nexport const createMutation = gql`\n    mutation createProject($input: Project!) {\n        output(input: $input) @rest(method: \"POST\", path: \"projects\") {\n            id\n        }\n    }\n`;\n","import { Breadcrumb, Col, Icon, Layout, Menu, Row } from 'antd';\nimport startsWith from 'lodash/startsWith';\nimport React, { Suspense } from 'react';\nimport { Query, QueryResult } from 'react-apollo';\nimport {\n    Link,\n    Redirect,\n    Route,\n    RouteComponentProps,\n    Switch,\n} from 'react-router-dom';\nimport { Route as RouteConfig } from '../../../../common/routing/route';\nimport { getQuery } from '../../../../queries/project';\nimport Loader from '../../../common/loader/loader';\nimport { Page, PageProps, PageState } from '../../../common/page';\n\nconst css = require('./index.module.scss');\n\nconst { Sider, Content } = Layout;\nconst DashboardPage = React.lazy(() => import('./dashboard/index') as any);\nconst DataPage = React.lazy(() => import('./data/index') as any);\nconst ScriptsPage = React.lazy(() => import('./scripts/index') as any);\nconst SettingsPage = React.lazy(() => import('./settings/index') as any);\nconst ExecutionPage = React.lazy(() => import('./execution/index') as any);\n\ninterface ProjectQueryResult {\n    output: {\n        name: string;\n    };\n}\n\nexport interface Params {\n    id: string;\n}\n\nexport interface State extends PageState {\n    collapsed: boolean;\n}\n\nexport interface Props extends PageProps<Params> {}\n\nexport default class ProjectPage extends Page<Params, Props, State> {\n    private readonly __routes: RouteConfig[];\n    private readonly __routeNames: { [path: string]: string };\n\n    constructor(props: Props) {\n        super(props, {\n            collapsed: false,\n        });\n\n        this.__handleMenuCollapseChange = this.__handleMenuCollapseChange.bind(\n            this,\n        );\n        this.__routes = [\n            {\n                path: `${props.match.url}/dashboard`,\n                label: 'Dasboard',\n                icon: 'dashboard',\n                component: DashboardPage,\n            },\n            {\n                path: `${props.match.url}/scripts`,\n                label: 'Scripts',\n                icon: 'file',\n                component: ScriptsPage,\n            },\n            {\n                path: `${props.match.url}/exec`,\n                label: 'Execution',\n                icon: 'rocket',\n                component: ExecutionPage,\n            },\n            {\n                path: `${props.match.url}/data`,\n                label: 'Data',\n                icon: 'database',\n                component: DataPage,\n            },\n            {\n                path: `${props.match.url}/settings`,\n                label: 'Settings',\n                icon: 'setting',\n                component: SettingsPage,\n            },\n        ];\n        this.__routeNames = {\n            '/home/projects': 'Projects',\n            [props.match.url]: props.match.params.id,\n            [`${props.match.url}/dashboard`]: 'Dasboard',\n            [`${props.match.url}/scripts`]: 'Scripts',\n            [`${props.match.url}/exec`]: 'Execution',\n            [`${props.match.url}/data`]: 'Data',\n            [`${props.match.url}/settings`]: 'Settings',\n        };\n\n        this.__renderBreadcrumb = this.__renderBreadcrumb.bind(this);\n        this.__renderRoutes = this.__renderRoutes.bind(this);\n    }\n\n    public render(): any {\n        const showText = !this.state.collapsed;\n        const selected = this.__currentTabKey();\n        const variables = {\n            id: this.getParam('id'),\n        };\n\n        return (\n            <Layout className={css.layout}>\n                <Sider collapsible onCollapse={this.__handleMenuCollapseChange}>\n                    <Icon type=\"caret-left\" />\n                    <Menu\n                        theme=\"dark\"\n                        className={css.menu}\n                        selectedKeys={[selected]}\n                    >\n                        {this.__routes.map(\n                            (config: RouteConfig, idx: number) => {\n                                const key = idx.toString();\n\n                                return (\n                                    <Menu.Item key={key}>\n                                        <Link to={config.path}>\n                                            <Icon type={config.icon} />\n                                            {showText ? config.label : null}\n                                        </Link>\n                                    </Menu.Item>\n                                );\n                            },\n                        )}\n                    </Menu>\n                    <Menu theme=\"dark\" className={css.bottomMenu}>\n                        <Menu.Item>\n                            <Icon type=\"logout\" />\n                            <span>Logout</span>\n                        </Menu.Item>\n                    </Menu>\n                </Sider>\n                <Layout className={css.contentLayout}>\n                    <Query query={getQuery} variables={variables}>\n                        {this.__renderBreadcrumb}\n                    </Query>\n                    <Content className={css.content}>\n                        <Row>\n                            <Col lg={24}>{this.__renderRoutes()}</Col>\n                        </Row>\n                    </Content>\n                </Layout>\n            </Layout>\n        );\n    }\n\n    private __currentTabKey(): string {\n        const { location } = this.props;\n\n        const found = this.__routes.findIndex(i =>\n            startsWith(location.pathname, i.path),\n        );\n\n        return found ? found.toString() : '0';\n    }\n\n    private __renderBreadcrumb({ data }: QueryResult<ProjectQueryResult>): any {\n        const props = this.props;\n\n        const BreadcrumbsItem = ({ match }: RouteComponentProps) => {\n            let title =\n                this.__routeNames[match.url] || (match.params as any).path;\n            let item;\n\n            if (props.match.params.id === title && data && data.output) {\n                title = data.output.name;\n            }\n\n            if (match.isExact) {\n                item = title;\n            } else {\n                item = <Link to={match.url}>{title}</Link>;\n            }\n\n            return (\n                <>\n                    <Breadcrumb.Item>{item}</Breadcrumb.Item>\n                    <Route\n                        path={`${match.url}/:path`}\n                        component={BreadcrumbsItem}\n                    />\n                </>\n            );\n        };\n\n        return (\n            <Breadcrumb style={{ margin: '16px 0' }}>\n                <Route path=\"/home/:path\" component={BreadcrumbsItem} />\n            </Breadcrumb>\n        );\n    }\n\n    private __renderRoutes(): any {\n        const { match, location } = this.props;\n\n        let redirect;\n\n        if (location.pathname === match.url) {\n            redirect = <Redirect to={`${match.url}/dashboard`} />;\n        }\n\n        return (\n            <Suspense fallback={<Loader size=\"large\" />}>\n                <Switch>\n                    {redirect}\n                    {this.__routes.map((config: RouteConfig) => {\n                        const Component: React.SFC<\n                            any\n                        > = config.component as any;\n                        const projectId = this.getParam('id');\n\n                        return (\n                            <Route\n                                key={config.path}\n                                path={config.path}\n                                component={(props: any) => {\n                                    return (\n                                        <Component\n                                            {...props}\n                                            project={projectId}\n                                        />\n                                    );\n                                }}\n                            />\n                        );\n                    })}\n                </Switch>\n            </Suspense>\n        );\n    }\n\n    private __handleMenuCollapseChange(collapsed: boolean): void {\n        this.setState({\n            collapsed,\n        });\n    }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"layout\":\"project_layout__2JwJz\",\"contentLayout\":\"project_contentLayout__1DCUP\",\"menu\":\"project_menu__2cON2\",\"bottomMenu\":\"project_bottomMenu__j_c2b\"};"],"sourceRoot":""}